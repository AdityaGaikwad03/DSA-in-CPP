// Practical 3: Write a program to convert an infix expression into postfix and evaluate it.



#include <iostream.h>
#include <conio.h>
#include <ctype.h>
#include <string.h>

#define MAX 100

char stackOp[MAX];
int topOp = -1;

int stackVal[MAX];
int topVal = -1;

void pushOp(char x)
{
    stackOp[++topOp] = x;
}

char popOp()
{
    return stackOp[topOp--];
}

char peekOp()
{
    return stackOp[topOp];
}

int isEmptyOp()
{
    if (topOp == -1)
        return 1;
    else
        return 0;
}

void pushVal(int x)
{
    stackVal[++topVal] = x;
}

int popVal()
{
    return stackVal[topVal--];
}

int precedence(char op)
{
    if (op == '+' || op == '-')
        return 1;
    if (op == '*' || op == '/')
        return 2;
    if (op == '^')
        return 3;
    return 0;
}

void infixToPostfix(char infix[], char postfix[])
{
    int i, k = 0;
    char ch;

    for (i = 0; infix[i] != '\0'; i++)
    {
        ch = infix[i];

        if (isdigit(ch))
        {
            postfix[k++] = ch;
        }
        else if (ch == '(')
        {
            pushOp(ch);
        }
        else if (ch == ')')
        {
            while (!isEmptyOp() && peekOp() != '(')
            {
                postfix[k++] = popOp();
            }
            popOp();
        }
        else
        {
            while (!isEmptyOp() && precedence(peekOp()) >= precedence(ch))
            {
                postfix[k++] = popOp();
            }
            pushOp(ch);
        }
    }

    while (!isEmptyOp())
    {
        postfix[k++] = popOp();
    }

    postfix[k] = '\0';
}

int evaluatePostfix(char postfix[])
{
    int i, a, b, res;
    char ch;

    for (i = 0; postfix[i] != '\0'; i++)
    {
        ch = postfix[i];

        if (isdigit(ch))
        {
            pushVal(ch - '0');
        }
        else
        {
            b = popVal();
            a = popVal();

            switch (ch)
            {
            case '+': pushVal(a + b); break;
            case '-': pushVal(a - b); break;
            case '*': pushVal(a * b); break;
            case '/': pushVal(a / b); break;
            case '^':
                res = 1;
                while (b > 0)
                {
                    res = res * a;
                    b--;
                }
                pushVal(res);
                break;
            }
        }
    }
    return popVal();
}

void main()
{
    char infix[50], postfix[50];
    int result;

    clrscr();

    cout << "Enter infix expression (single digit operands): ";
    cin >> infix;

    infixToPostfix(infix, postfix);

    cout << "Postfix: " << postfix << endl;

    result = evaluatePostfix(postfix);

    cout << "Result: " << result;

    getch();
}










